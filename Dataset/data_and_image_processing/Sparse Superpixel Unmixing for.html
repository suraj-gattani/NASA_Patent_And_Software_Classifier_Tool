The algorithm computes statistically likely combinations of constituents based on a set of possible constituent minerals whose abundances are uncertain. Our approach uses a library of source spectra from laboratory experiments or previous remote observations. A superpixel segmentation strategy improves analysis time by orders of magnitude, permitting incorporation into an interactive user session.